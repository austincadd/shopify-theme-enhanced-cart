<style>
/* Staggered Left-to-Right Animation for Product Cards */
.featured-products-section .sample-pack-card {
  opacity: 0 !important;
  transform: translateX(-50px) !important;
  transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-start !important;
  gap: 0.75rem !important;
  padding: 1rem !important;
  background: rgba(255, 255, 255, 0.03) !important;
  border-radius: 15px !important;
  overflow: hidden !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  margin-bottom: 1.5rem !important;
  text-align: left !important;
  position: relative !important;
  max-width: 300px !important;
}

.featured-products-section .sample-pack-card::before {
  content: '' !important;
  position: absolute !important;
  top: -1px !important;
  left: -1px !important;
  right: -1px !important;
  bottom: -1px !important;
  border-radius: 15px !important;
  background: linear-gradient(135deg, rgba(75, 0, 130, 0.4), rgba(138, 43, 226, 0.4), rgba(72, 61, 139, 0.4), rgba(106, 90, 205, 0.4), rgba(123, 104, 238, 0.4)) !important;
  opacity: 0 !important;
  transition: all 0.4s ease !important;
  z-index: -1 !important;
}

.featured-products-section .sample-pack-card:hover::before {
  opacity: 1 !important;
  animation: glow-pulse 2s ease-in-out infinite !important;
}

.featured-products-section .sample-pack-card:hover {
  transform: translateX(0) translateY(-5px) !important;
  box-shadow: 0 20px 40px rgba(138, 43, 226, 0.3) !important;
  background: rgba(255, 255, 255, 0.05) !important;
  cursor: pointer !important;
}

@keyframes glow-pulse {
  0%, 100% {
    box-shadow: 0 0 15px rgba(138, 43, 226, 0.3) !important;
  }
  50% {
    box-shadow: 0 0 20px rgba(138, 43, 226, 0.4), 0 0 25px rgba(75, 0, 130, 0.2) !important;
  }
}

@keyframes image-glow-pulse {
  0%, 100% {
    box-shadow: 0 0 10px rgba(138, 43, 226, 0.2) !important;
  }
  50% {
    box-shadow: 0 0 15px rgba(138, 43, 226, 0.3), 0 0 20px rgba(75, 0, 130, 0.15) !important;
  }
}

/* Page Background Animations - Override existing styles */
html body {
  background: #000000 !important;
  position: relative !important;
  overflow-x: hidden !important;
}

/* Override the existing body::before with much higher specificity */
html body::before {
  content: '' !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  z-index: -1 !important;
  background: 
    radial-gradient(circle at 20% 50%, rgba(255, 59, 47, 0.4) 0%, transparent 60%),
    radial-gradient(circle at 80% 20%, rgba(255, 75, 71, 0.35) 0%, transparent 60%),
    radial-gradient(circle at 50% 80%, rgba(122, 60, 255, 0.3) 0%, transparent 60%),
    radial-gradient(circle at 30% 30%, rgba(14, 203, 230, 0.25) 0%, transparent 50%),
    linear-gradient(180deg, #0c0b1a 0%, #1a1330 100%) !important;
  animation: colorCycle 15s ease-in-out infinite !important;
  filter: blur(0.5px) saturate(1.2) !important;
  will-change: background !important;
}

/* Floating Orbs - Use a different approach */
.featured-products-section {
  background: linear-gradient(135deg, #050505 0%, #0f0f1a 50%, #050505 100%) !important;
  padding: 0.5rem 0 0 0 !important;
  position: relative !important;
  z-index: 2 !important;
  overflow: hidden !important;
}

/* Animated Background Elements - Match featured-packs styling */
.featured-products-section::before {
  content: '' !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background-image: 
    radial-gradient(circle at 20% 80%, rgba(102, 255, 204, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(255, 45, 149, 0.1) 0%, transparent 50%) !important;
  animation: backgroundPulse 8s ease-in-out infinite !important;
  z-index: 1 !important;
}

@keyframes backgroundPulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}






/* Grid Layout for Smaller Cards */
.sample-packs-grid {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
  gap: 1.5rem !important;
  margin-bottom: 2.5rem !important;
  max-width: 1200px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

.featured-products-section .sample-pack-card.animate-in {
  opacity: 1 !important;
  transform: translateX(0) !important;
}

/* Product Image Container */
.featured-products-section .product-image-container {
  width: 100% !important;
  max-width: 200px !important;
  height: auto !important;
  border-radius: 12px !important;
  overflow: hidden !important;
  margin-bottom: 0.75rem !important;
  align-self: flex-start !important;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  position: relative !important;
  transition: all 0.3s ease !important;
}

.featured-products-section .product-image-container::before {
  content: '' !important;
  position: absolute !important;
  top: -2px !important;
  left: -2px !important;
  right: -2px !important;
  bottom: -2px !important;
  border-radius: 14px !important;
  background: linear-gradient(135deg, rgba(75, 0, 130, 0.3), rgba(138, 43, 226, 0.3), rgba(72, 61, 139, 0.3), rgba(106, 90, 205, 0.3), rgba(123, 104, 238, 0.3)) !important;
  opacity: 0 !important;
  transition: all 0.3s ease !important;
  z-index: -1 !important;
}

.featured-products-section .product-image-container:hover::before {
  opacity: 1 !important;
  animation: image-glow-pulse 2s ease-in-out infinite !important;
}

.featured-products-section .sample-pack-card:hover .product-image {
  opacity: 0.8 !important;
  transition: opacity 0.3s ease !important;
}

.featured-products-section .product-image {
  max-width: 100% !important;
  height: auto !important;
  object-fit: contain !important;
  border-radius: 12px !important;
  object-position: center !important;
  background: rgba(255, 255, 255, 0.05) !important;
  display: block !important;
}

.featured-products-section .product-placeholder {
  width: 100% !important;
  height: 100% !important;
  background: linear-gradient(135deg, #ff3b2f, #7a3cff) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 16px !important;
}

.featured-products-section .placeholder-icon {
  font-size: 2rem !important;
  color: white !important;
  font-weight: bold !important;
}

/* Product Card Link */
.featured-products-section .product-card-link {
  text-decoration: none !important;
  color: inherit !important;
  display: block !important;
  width: 100% !important;
  position: relative !important;
  z-index: 1 !important;
}

.featured-products-section .product-card-link:hover {
  text-decoration: none !important;
  color: inherit !important;
}

/* Buy Now Container */
.featured-products-section .buy-now-container {
  position: absolute !important;
  top: 1rem !important;
  right: 1rem !important;
  z-index: 10 !important;
  pointer-events: auto !important;
}

/* Product Info */
.featured-products-section .product-info {
  width: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-start !important;
  gap: 1rem !important;
}

.featured-products-section .product-title-price-row {
  display: flex !important;
  justify-content: flex-start !important;
  align-items: center !important;
  width: 100% !important;
  gap: 0.5rem !important;
}

.featured-products-section .product-title {
  font-size: 1.4rem !important;
  font-weight: 600 !important;
  color: #ffffff !important;
  margin: 0 !important;
  text-align: left !important;
}


.featured-products-section .product-price {
  margin: 0 !important;
  text-align: left !important;
  flex-shrink: 0 !important;
}

.featured-products-section .price-container {
  display: flex !important;
  justify-content: flex-start !important;
  align-items: center !important;
  gap: 0.5rem !important;
}

.featured-products-section .price-separator {
  color: rgba(255, 255, 255, 0.5) !important;
  font-size: 1.8rem !important;
  font-weight: 300 !important;
  margin: 0 0.5rem !important;
}

.featured-products-section .current-price {
  font-size: 1.2rem !important;
  font-weight: 700 !important;
  color: #ffffff !important;
}

.featured-products-section .original-price {
  font-size: 1rem !important;
  color: rgba(255, 255, 255, 0.5) !important;
  text-decoration: line-through !important;
  margin-left: 0.5rem !important;
}

.featured-products-section .add-btn-container {
  position: relative !important;
  display: flex !important;
  align-items: center !important;
  flex-shrink: 0 !important;
}

.featured-products-section .add-btn-icon {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 0.25rem !important;
  cursor: pointer !important;
  transition: opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1) !important;
}

.featured-products-section .add-btn-icon svg {
  width: 24px !important;
  height: 24px !important;
}

.featured-products-section .add-btn-hover {
  position: absolute !important;
  right: 0 !important;
  top: 50% !important;
  transform: translateY(-50%) translateX(70%) !important;
  background: linear-gradient(135deg, #ff3b2f, #ff7f32, #ff2566, #7a3cff, #0ecbe6) !important;
  color: #ffffff !important;
  border: none !important;
  border-radius: 25px !important;
  padding: 0.5rem 1rem !important;
  cursor: pointer !important;
  transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1) !important;
  display: flex !important;
  align-items: center !important;
  gap: 0.5rem !important;
  font-size: 0.9rem !important;
  font-weight: 600 !important;
  white-space: nowrap !important;
  opacity: 0 !important;
  visibility: hidden !important;
  box-shadow: 0 4px 15px rgba(122, 60, 255, 0.3) !important;
}

.featured-products-section .add-btn-container:hover .add-btn-hover {
  transform: translateY(-50%) translateX(0) !important;
  opacity: 1 !important;
  visibility: visible !important;
}

.featured-products-section .add-btn-hover {
  transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1) !important;
}

.featured-products-section .add-btn-container:not(:hover) .add-btn-hover {
  transition: opacity 0.6s cubic-bezier(0.23, 1, 0.32, 1) !important;
}

.featured-products-section .add-btn-container:hover .add-btn-icon {
  opacity: 0 !important;
  transition: opacity 0.08s cubic-bezier(0.23, 1, 0.32, 1) !important;
}

.featured-products-section .add-btn-icon {
  transition: opacity 0.08s cubic-bezier(0.23, 1, 0.32, 1) !important;
}

.featured-products-section .add-btn-hover:hover {
  transform: translateY(-50%) translateX(0) scale(1.05) !important;
  box-shadow: 0 6px 20px rgba(122, 60, 255, 0.4) !important;
  transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1) !important;
}

.featured-products-section .add-btn-hover:disabled {
  opacity: 0.5 !important;
  cursor: not-allowed !important;
}

.featured-products-section .add-btn-hover:disabled:hover {
  transform: translateY(-50%) translateX(0) !important;
  box-shadow: 0 4px 15px rgba(122, 60, 255, 0.3) !important;
}


/* Staggered delays for left-to-right effect */
.featured-products-section .sample-pack-card:nth-child(1) { transition-delay: 0.1s !important; }
.featured-products-section .sample-pack-card:nth-child(2) { transition-delay: 0.2s !important; }
.featured-products-section .sample-pack-card:nth-child(3) { transition-delay: 0.3s !important; }
.featured-products-section .sample-pack-card:nth-child(4) { transition-delay: 0.4s !important; }
.featured-products-section .sample-pack-card:nth-child(5) { transition-delay: 0.5s !important; }
.featured-products-section .sample-pack-card:nth-child(6) { transition-delay: 0.6s !important; }
.featured-products-section .sample-pack-card:nth-child(7) { transition-delay: 0.7s !important; }
.featured-products-section .sample-pack-card:nth-child(8) { transition-delay: 0.8s !important; }

/* Override any conflicting styles */
.featured-products-section .sample-pack-card[style*="transition"] {
  transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
}

/* Responsive Design */
@media screen and (max-width: 768px) {
  .featured-products-section .sample-pack-card {
    flex-direction: column !important;
    text-align: center !important;
  }
  
  .featured-products-section .product-image-container {
    flex: none !important;
    width: 100% !important;
    max-width: 300px !important;
    margin: 0 auto !important;
  }
}
</style>

<div class="featured-products-section section" id="shop">
  
  
  <div class="page-width">
    <div class="section-header">
      {% if section.settings.heading != blank %}
        <h2 class="featured-products-heading">{{ section.settings.heading }}</h2>
      {% endif %}
      
      {% if section.settings.subheading != blank %}
        <p class="featured-products-subheading">{{ section.settings.subheading }}</p>
      {% endif %}
    </div>
    
    <div class="sample-packs-grid">
      {% comment %} Get all products instead of from a specific collection {% endcomment %}
      {% assign products = collections.all.products %}
      {% assign products_to_show = section.settings.products_to_show | default: 6 %}
      
      {% if products.size > 0 %}
        {% for product in products limit: products_to_show %}
          <div class="sample-pack-card">
            <a href="{{ product.url }}" class="product-card-link" style="text-decoration: none; color: inherit; display: block; width: 100%; cursor: pointer;">
              <div class="product-image-container">
                {% if product.featured_media %}
                  <img src="{{ product.featured_media | image_url: width: 300 }}" 
                       alt="{{ product.featured_media.alt | escape }}"
                       loading="lazy"
                       class="product-image">
                {% else %}
                  <div class="product-placeholder">
                    <div class="placeholder-icon">MUSIC</div>
                  </div>
                {% endif %}
              </div>
              
              <div class="product-info">
                <div class="product-title-price-row">
                <h3 class="product-title">{{ product.title | default: 'Sample Pack' }}</h3>
                  <span class="price-separator">|</span>
                <div class="product-price">
                  <div class="price-container">
                    <span class="current-price">
                      {% if product.price %}{{ product.price | money }}{% else %}$29.99{% endif %}
                    </span>
                    {% if product.compare_at_price > product.price %}
                      <span class="original-price">{{ product.compare_at_price | money }}</span>
                    {% endif %}
                  </div>
                </div>
                  <span class="price-separator">|</span>
                
                </div>
              </div>
            </a>
            
            <!-- Buy Now Button - Outside the link to prevent navigation -->
            {% if product.available %}
              <div class="buy-now-container" style="position: absolute; top: 1rem; right: 1rem; z-index: 10;">
                <div class="add-btn-container">
                  <div class="add-btn-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M19 7H16V6C16 3.79 14.21 2 12 2S8 3.79 8 6V7H5C3.9 7 3 7.9 3 9V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V9C21 7.9 20.1 7 19 7ZM10 6C10 4.9 10.9 4 12 4S14 4.9 14 6V7H10V6ZM19 19H5V9H19V19Z" fill="#ffffff"/>
                    </svg>
                  </div>
                  <form action="/cart/add" method="post" enctype="multipart/form-data" class="product-form" onsubmit="event.preventDefault(); event.stopPropagation(); addToCartAndOpenDrawer(this, '{{ product.selected_or_first_available_variant.id }}'); return false;">
                    <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                    <button type="submit" class="add-btn-hover" title="Add to Cart" onclick="event.stopPropagation();">
                      <span>BUY NOW</span>
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 7H16V6C16 3.79 14.21 2 12 2S8 3.79 8 6V7H5C3.9 7 3 7.9 3 9V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V9C21 7.9 20.1 7 19 7ZM10 6C10 4.9 10.9 4 12 4S14 4.9 14 6V7H10V6ZM19 19H5V9H19V19Z" fill="#ffffff"/>
                      </svg>
                    </button>
                  </form>
                </div>
              </div>
            {% else %}
              <div class="buy-now-container" style="position: absolute; top: 1rem; right: 1rem; z-index: 10;">
                <div class="add-btn-container">
                  <div class="add-btn-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M19 7H16V6C16 3.79 14.21 2 12 2S8 3.79 8 6V7H5C3.9 7 3 7.9 3 9V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V9C21 7.9 20.1 7 19 7ZM10 6C10 4.9 10.9 4 12 4S14 4.9 14 6V7H10V6ZM19 19H5V9H19V19Z" fill="#ffffff"/>
                    </svg>
                  </div>
                  <button class="add-btn-hover" disabled title="Sold Out">
                    <span>BUY NOW</span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M19 7H16V6C16 3.79 14.21 2 12 2S8 3.79 8 6V7H5C3.9 7 3 7.9 3 9V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V9C21 7.9 20.1 7 19 7ZM10 6C10 4.9 10.9 4 12 4S14 4.9 14 6V7H10V6ZM19 19H5V9H19V19Z" fill="#ffffff"/>
                    </svg>
                  </button>
                </div>
              </div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <div class="no-products-message">
          <h3>No products available</h3>
          <p>Check back soon for new sample packs!</p>
        </div>
      {% endif %}
    </div>
    
  </div>
</div>

<script>
// Staggered animation for featured products
function initProductsAnimation() {
  console.log('Featured products animation script loaded');
  
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -100px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        console.log('Featured products section is in view, starting animation');
        const cards = entry.target.querySelectorAll('.sample-pack-card');
        console.log('Found product cards:', cards.length);
        
        // Cards are already in initial state from HTML
        
        cards.forEach((card, index) => {
          console.log(`Animating product card ${index + 1}`);
          setTimeout(() => {
            card.classList.add('animate-in');
            console.log(`Product card ${index + 1} animated`);
          }, index * 150); // 150ms delay between each card
        });
        observer.unobserve(entry.target); // Only animate once
      }
    });
  }, observerOptions);

  // Observe the featured products section
  const featuredSection = document.querySelector('.featured-products-section');
  console.log('Featured products section found:', !!featuredSection);
  
  if (featuredSection) {
    observer.observe(featuredSection);
    console.log('Products observer attached to section');
    
    // Add click handlers to prevent buy button from triggering card navigation
    const buyButtons = featuredSection.querySelectorAll('.buy-now-container');
    buyButtons.forEach(button => {
      button.addEventListener('click', function(e) {
        console.log('Buy button clicked - preventing card navigation');
        e.stopPropagation();
        e.preventDefault();
      });
    });
    
    // Add click handlers for product card navigation
    const productCards = featuredSection.querySelectorAll('.product-card-link');
    productCards.forEach(card => {
      card.addEventListener('click', function(e) {
        console.log('Product card clicked - navigating to product page');
        // Let the default link behavior handle navigation
      });
    });
  } else {
    // Fallback: try to find the section by ID
    const sectionById = document.querySelector('#shop');
    if (sectionById) {
      observer.observe(sectionById);
      console.log('Products observer attached to section by ID');
    }
  }
}

// Run when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initProductsAnimation);
} else {
  initProductsAnimation();
}
</script>

{% schema %}
{
  "name": "Featured Products",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "textarea", 
      "id": "subheading",
      "label": "Subheading"
    },
    {
      "type": "collection",
      "id": "collection", 
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12, 
      "step": 1,
      "default": 5,
      "label": "Number of products to show"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show View All button",
      "default": true
    },
    {
      "type": "text", 
      "id": "view_all_text",
      "label": "View All button text",
      "default": "View All Products"
    }
  ],
  "presets": [
    {
      "name": "Featured Products"
    }
  ]
}
{% endschema %}
